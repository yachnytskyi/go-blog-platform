name: Docker Login and Version Tag

on:
  workflow_call:

jobs:
  docker-login-and-version-tag:
    runs-on: ubuntu-latest
    steps:
      - name: Log in to DockerHub
        uses: docker/login-action@v2
        with:
          username: ${{ secrets.DOCKER_USERNAME }}
          password: ${{ secrets.DOCKER_PASSWORD }}

      - name: Determine Version Tag
        id: version
        run: |
          # Fetch all Git tags
          git fetch --tags
          
          # Get the latest tag (without incrementation)
          LATEST_TAG=$(git tag -l --sort=-v:refname | head -n 1)

          # Set the version to the latest tag
          VERSION="$LATEST_TAG"
          
          echo "VERSION=$VERSION" >> $GITHUB_ENV
          echo "Version Tag: $VERSION"
